<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>登录/Login</title>
		<link rel="stylesheet" href="js/bootstrap-3.3.7-dist/css/bootstrap.css" />
		<script src="./js/jquery-1.11.1/jquery.js"></script>
		<script src="js/bootstrap-3.3.7-dist/js/bootstrap.js"></script>
	</head>
	<body style="background-color: #dfe6e9;">
		<div class="alert alert-danger alert-dismissable hide" role="alert" style="position: absolute;left: 0;right: 0;">
	       <button type="button" class="close" data-dismiss="alert" aria-label="Close">          
	          <span aria-hidden="true">&times;</span>
	       </button>
	       <strong id="alerttext"> </strong>
	   </div>
		<div class="col-lg-4 col-md-4 col-sm-4"> </div>
		<div class="col-lg-4 col-md-4 col-sm-4" style="margin-top: 150px;">
			<div style="margin-bottom: 30px;">
					<h2 class="text-center">SuperMarket</h2>
					<h2 class="text-center" style="margin-top: 10px;margin-bottom: 15px;"><small>xxxx超市欢迎您的登录</small></h2>
			</div>
			<form class="form-horizontal text-left" name="login_form" method="post" action="Login">
			  <div class="form-group">
			    <label class="col-sm-2 control-label">Username</label>
			    <div class="col-sm-10">
			      <input type="text" class="form-control" name="inputStaffid" id="inputStaffid" placeholder="Username" required="required">
			    </div>
			  </div>
			  <div class="form-group">
			    <label class="col-sm-2 control-label">Password</label>
			    <div class="col-sm-10">
			      <input type="password" class="form-control" name="inputPassword" id="inputPassword" placeholder="Password" required="required">
			    </div>
			  </div>
			  <div class="form-group" style="margin-top: 25px;margin-bottom: 20px;">
			    <div class="col-sm-offset-2 col-sm-10">
			      <div class="checkbox col-lg-6 text-left">
			        <label>
			          <input type="checkbox"> Remember me
			        </label>
			      </div>
				  <div class="forgpass col-lg-6 text-right">
					  <a tabindex="0" id="forg" class="btn btn-sm btn-info" role="button" data-placement="top" data-toggle="popover" data-trigger="focus" title="忘记密码" data-content="如果您忘记了登录密码,请与系统管理员联系">忘记密码</a>
				  </div>
				  <script>
				  $("#forg").click(function () { 
				  	$('#forg').popover('show');
					})
				  </script>
			    </div>
			  </div>
			  <div class="form-group text-center">
			    <div class="col-sm-offset-2 col-sm-10" style="margin-top: 10px;">
			      <input type="button" class="btn btn-primary btn-lg btn-block" onclick="checkLogin()" value="Sign in">
			    </div>
			  </div>
			</form>
		</div>
		<script type="text/javascript">
				    var xmlhttp;
					function checkLogin(){
						var staffId = document.getElementById("inputStaffid").value;
						var password = document.getElementById("inputPassword").value;
						if(staffId.length <= 0 || password.length<=0){
							document.getElementById("alerttext").innerHTML="用户名或密码为空";
							$('.alert-danger').removeClass('hide').addClass('in');
						}
						else{$('.alert-danger').removeClass('in').addClass('hide');
							if (window.XMLHttpRequest) {xmlhttp=new XMLHttpRequest();}
							else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}	
							xmlhttp.open("POST","Login",true);
							xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
							xmlhttp.send("inputStaffid="+staffId+"&inputPassword="+password);
							xmlhttp.onreadystatechange=getResult;
						}
					}
					
					function getResult(){
						if (xmlhttp.readyState==4) {		
							if(xmlhttp.status==200){
								var rec=xmlhttp.responseText;
								if(rec == 1){
									window.location.href="SuperMarket/index.html";
								}
								if(rec == 2){
									document.getElementById("alerttext").innerHTML="用户名与密码不匹配";
									$('.alert-danger').removeClass('hide').addClass('in');
								}
								if(rec == 3){
									document.getElementById("alerttext").innerHTML="该账号已被禁用";
									$('.alert-danger').removeClass('hide').addClass('in');
								}
							}
							else{
								alert("连接失败");
							}
						}
					}
			    </script>
	</body>
</html>
