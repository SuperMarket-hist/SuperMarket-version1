<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>注册/Register</title>
		<link rel="stylesheet" href="././js/bootstrap-3.3.7-dist/css/bootstrap.css" />
		<link rel="stylesheet" href="css/index.css" />
		<script src="././js/jquery-1.11.1/jquery.js"></script>
		<script src="././js/bootstrap-3.3.7-dist/js/bootstrap.js"></script>
	</head>
	<body>
		<div class="col-lg-2"></div>
		<div class="col-lg-4">
			<form method="post" action="Register" name = "Regist_form">
			  <div class="form-group">
			    <label for="exampleInputEmail1">员工编号</label>
			    <input type="text" class="form-control" name="staffid" autocomplete="off" placeholder="staffid" required="required" onblur="loadCheck()"title="Warning"
					data-container="body" data-toggle="popover" data-placement="right"
					data-content="存在重复员工编号，不允许注册">
			  </div>
			  <div class="form-group">
			    <label for="exampleInputEmail1">员工姓名</label>
			    <input type="text" class="form-control" name="staffname" autocomplete="off" placeholder="staffname" required="required">
			  </div>
			  <div class="form-group">
			    <label for="exampleInputPassword1">登录密码</label>
			    <input type="password" class="form-control" name="password" placeholder="Password" required="required">
			  </div>
			  <div class="form-group">
			    <label for="exampleInputEmail1">员工薪资</label>
			    <input type="text" class="form-control" name="salary" placeholder="salary" aria-label="Amount (to the nearest dollar) required="required">
			  </div>
			  <div class="form-group">
			    <label for="exampleInputEmail1">入职时间</label>
			    <input type="date" class="form-control" name="createtime" placeholder="createtime" required="required">
			  </div>
			  <div class="form-group">
				<select name="type" style="height: 34px;width: 136px;padding-top: 6px;padding-bottom: 6px;font-size: 14px;margin-top: 2px;border-radius: 1px;">
				  <option>请选择员工类型</option>
				  <option value="1">超级管理员</option>
				  <option value="2">仓库管理员</option>
				  <option value="3">收银员</option>
				  <option value="4">售货员</option>
				</select>
				<select name="dataflag"  style="height: 34px;width: 136px;padding-top: 6px;padding-bottom: 6px;font-size: 14px;margin-top: 2px;border-radius: 1px;">
					<option>请设置帐号状态</option>
					<option value="1">可用</option>
					<option value="0">禁用</option>
				</select>
			  </div>
			  <button type="submit" id="submit_btn" class="btn btn-primary">创建账号</button>
			</form>
			<script type="text/javascript">
				var xmlhttp;
				function loadCheck(){
					var staffId = document.Regist_form.staffid.value;
					if (window.XMLHttpRequest) {xmlhttp=new XMLHttpRequest();}
					else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}	
					xmlhttp.onreadystatechange=getResult;
					xmlhttp.open("POST","checkIdAvailable",true);
					xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
					xmlhttp.send("staffId="+staffId);		
				}
				
				function getResult(){
					if (xmlhttp.readyState==4) {		
						if(xmlhttp.status==200){
							var rec=xmlhttp.responseText;
							if(rec == "false"){
								document.getElementById("submit_btn").className="btn btn-primary disabled"
								$(function (){
									$("[data-toggle='popover']").popover();
								});
							}
						}
						else{
							alert("连接失败");
						}
					}
				}
			</script>
		</div>
	</body>
</html>
